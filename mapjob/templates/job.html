{% extends "job.html" %}
{% load static %}
{% load mapjob %}
{% load i18n %}
{% load juntagrico.common %}
{% load juntagrico.config %}

{% block page_title %}
    {% if not job|is_map_job %}
        {{ block.super }}
    {% else %}
        <h3>
        {{ job }}
        <a href="{% url 'admin:mapjob_mapjob_change' job.id %}" class="edit">
            <i class="fas fa-pen">
            </i>
        </a>
        </h3>
    {% endif %}
{% endblock %}

{% block styles %}
    {{ block.super }}
    {% if job|is_map_job %}
        {% include 'mapjob/snippets/map/styles.html' %}
    {% endif %}
{% endblock %}

{% block time %}
    {% if not job|is_map_job %}
        {{ block.super }}
    {% else %}
        <div class="alert alert-warning">
            Weitere Flyergebiete findest du
            <a href="{% url "mapjob:member_dashboard" %}" style="text-decoration: underline">
                auf der Karte
            </a>.
        </div>
    {% endif %}
{% endblock %}

{% block location %}
    {% if job|is_map_job %}
        <div class="row pb-4">
            <div class="col-md-3">
                {% trans "Gebiet" %}:
            </div>
            <div class="col-md-9">
                <div class="map-container"></div>
            </div>
        </div>
    {% else %}
        {{ block.super }}
    {% endif %}
{% endblock %}

{% block contact %}
    {% if not job|is_map_job %}
        {{ block.super }}
    {% endif %}
{% endblock %}

{% block subscribe %}
    {% if job|is_map_job %}
        {% if job.free_slots > 0 %}
            <div class="row">
                <div class="col-md-3">
                    {% trans "Ich trage mich ein" %}:
                </div>
                <div class="col-md-3">
                    {% include "mapjob/snippets/member/action/register.html" %}
                </div>
            </div>
        {% endif %}
    {% else %}
        {{ block.super }}
    {% endif %}
{% endblock %}

{% block scripts %}
    {% if not job|is_map_job %}
        {{ block.super }}
    {% else %}
        {{ job.geo_area|json_script:'map_job_data' }}
        {% include 'mapjob/snippets/map/scripts.html' %}
        {{ job.location|json_script:'location_data' }}
        <script type="text/javascript" src="{% static 'juntagrico/external/require.min.js' %}" data-main="{% static 'juntagrico/js/initJob.js' %}">
        </script>
    {% endif %}
{% endblock %}
